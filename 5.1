# -------------------------------------------------------------- #
# from IPython.display import display
import numpy as np
import matplotlib.pyplot as plt
import pandas as pd
import mglearn
# -------------------------------------------------------------- #
from sklearn.datasets import make_blobs
from sklearn.model_selection import train_test_split
# 5.1.1 scikit-learn의 교차 검증
from sklearn.model_selection import cross_val_score
from sklearn.datasets import load_iris
from sklearn.linear_model import LogisticRegression
# 5.1.3 계층별 k-겹 교차 검증과 그외 전략들
from sklearn.datasets import load_iris
# -------------------------------------------------------------- #

# 인위적인 데이터셋을 만듭니다.
# X, y = make_blobs(random_state=0)
# 데이터와 타깃 레이블을 훈련 세트와 테스트 세트로 나눕니다.
# X_train, X_test, y_train, y_test = train_test_split(X, y, random_state=0)
# 모델 객체를 만들고 훈련 세트로 학습시킵니다.
# logreg = LogisticRegression().fit(X_train, y_train)
# 모델을 테스트 세트로 평가합니다.
# print("테스트 세트 점수 : {:.2f}".format(logreg.score(X_test, y_test)))

# 5.1 교차 검증
# mglearn.plots.plot_cross_validation()
# plt.show()

# 5.1.1 scikit-learn의 교차 검증
iris = load_iris()
logreg = LogisticRegression()
# 폴드 5개
scores = cross_val_score(logreg, iris.data, iris.target, cv=5)
print("교차 검증 점수      : {}".format(scores))
print("교차 검증 평균 점수 : {:.2f}".format(scores.mean()))

# 5.1.3 계층별 k-겹 교차 검증과 그외 전략들
iris = load_iris()
print("Iris lable : {}".format(iris.target))

# 계층별 k-겹 교차 검증
# mglearn.plots.plot_stratified_cross_validation()
# plt.show()

# 교차 검증 상세 옵션
from sklearn.model_selection import KFold
kfold = KFold(n_splits=5)
print("교체 검증 점수 : {}".format(cross_val_score(logreg, iris.data, iris.target, cv=kfold)))
